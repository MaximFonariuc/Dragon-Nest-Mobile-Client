---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by declanchen.
--- DateTime: 2018/5/3 21:20
---

--520紅包界面
require "Lua520FestivityDoc.lua"

---@class Lua520FestivityRedPackageDlg
Lua520FestivityRedPackageDlg = {}
local this = Lua520FestivityRedPackageDlg

---@type UnityEngine.GameObject
local selfObj = nil

---@type UnityEngine.Transform
local selfTrans = nil

---@type NGUI.UILabel
local PlayerNameLb = nil

---@type NGUI.UILabel
local desLb = nil

---@type NGUI.UILabel
local CoinNumLb = nil

---@type UnityEngine.GameObject
local GetBtnObj = nil

---@type NGUI.UISprite
local theHeadIconSpr = nil

---@type NGUI.UITexture
local theHeadIconTexture = nil


function Lua520FestivityRedPackageDlg.Init()

    if IsNil(selfObj) or IsNil(selfTrans) then
        return
    end

    PlayerNameLb = selfTrans:Find("DetailMenu/Avatar/Name"):GetComponent("UILabel")

    desLb = selfTrans:Find("DetailMenu/Reason"):GetComponent("UILabel")

    CoinNumLb = selfTrans:Find("DetailMenu/Note"):GetComponent("UILabel")

    if not IsNil(CoinNumLb) then
        CoinNumLb.gameObject:SetActive(false)
    end

    GetBtnObj = selfTrans:Find("DetailMenu/Reply").gameObject

    if not IsNil(GetBtnObj) then
        Hotfix.SetClickCallback(GetBtnObj, this.GetRedPacketOnClick)
    end

    -- theHeadIconSpr = selfTrans:Find("DetailMenu/Avatar/Sprite"):GetComponent("UISprite")

    -- theHeadIconTexture = selfTrans:Find("DetailMenu/Avatar/Texture"):GetComponent("IXUITexture")
end

function Lua520FestivityRedPackageDlg.RefreshHeadIcon()
    -- local Profession = 1
    if not IsNil(theHeadIconSpr) then
        -- local headStr = Hotfix.CallSingleMethod("XProfessionSkillMgr",true, false, "GetProfHeadIcon", Profession)

        local thePlatHeadUrl = Lua520FestivityDoc.GetHeadPicSpriteName()

        theHeadIconSpr.spriteName = thePlatHeadUrl

        local theuiBehaviour = Hotfix.GetSingleMember("XFriendsView", "uiBehaviour", true, false, false)

        Hotfix.CallSingleMethod("XUICacheImage",true,false,"Load",thePlatHeadUrl,theHeadIconTexture, theuiBehaviour)
    end 
end

function Lua520FestivityRedPackageDlg.GetRedPacketOnClick()
    Lua520FestivityDoc.ArgOpen520FestivityRedPacket()
end

function Lua520FestivityRedPackageDlg.OnShow()
    Lua520FestivityDoc.SetRedBagFrame(this)
    this.RefreshUI()

    -- this.RefreshHeadIcon()
end

function Lua520FestivityRedPackageDlg.RefreshUI()
    if not IsNil(PlayerNameLb) then
        PlayerNameLb.text = Lua520FestivityDoc.GetRedPacketPlayerName()
    end

    print"11"
    if not IsNil(desLb) then
        print"22"
        desLb.text = Hotfix.GetStringTable("festivalRedPackageTips",Lua520FestivityDoc.GetRedPacketPlayerName())--"恭喜你有机会领取到"..PlayerNameLb.."大佬给你发送的红包"
    end
end

function Lua520FestivityRedPackageDlg.OnHide()
    Lua520FestivityDoc.UnLoadRedBagFrame()
end

---------------------------------------------------- Unity MonoBehaviour 生命周期 -------------------------------------------------
function Lua520FestivityRedPackageDlg.Awake(go)
    selfObj = go

    selfTrans = selfObj.transform

    this.Init()
end

function Lua520FestivityRedPackageDlg.Start()

end

function Lua520FestivityRedPackageDlg.OnEnable()

end

function Lua520FestivityRedPackageDlg.OnDisable()

end

function Lua520FestivityRedPackageDlg.OnDestroy()

end